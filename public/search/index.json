[{"content":"Before installation Create a virtual machine and adjust depend config on your need(Except for the UEFI firmware part):\nTo prevent the creation of vmem files for acceleration, add the following lines to your .vmx file(:\n1 2 3 4 5 prefvmx.minVmMemPct = \u0026#34;100\u0026#34; MemTrimRate = \u0026#34;0\u0026#34; mainMem.useNamedFile = \u0026#34;FALSE\u0026#34; sched.mem.pshare.enable = \u0026#34;FALSE\u0026#34; prefvmx.useRecommendedLockedMemSize = \u0026#34;TRUE\u0026#34; Boot up the vm, and check if the firmware is UEFI or not:\n1 ls /sys/firmware/efi/efivars if it\u0026rsquo;s legacy BIOS, it will returns No such file or directory.\nPartitioning Create a new GPT partition table and partitioned with an EFI Partition no less than 300MiB and an Linux partition with cgdisk or any other partition tools you want to use:\n1 cgdisk /dev/sda Format partitions EFI 1 mkfs.fat -F32 /dev/sda1 Root system 1 mkfs.btrfs -f -L Arch /dev/sda2 Building BTRFS subvolume @：corresponding to / @home：corresponding to/home @cache：corresponding to /var/cache @docker：corresponding to /var/lib/docker @log：corresponding to /var/log Enabling COW in @cache, @log is not needed.\nMount root partition to /mnt: 1 mount -t btrfs -o compress=lzo /dev/sda2 /mnt Generally we lzo is good enough. Reports shows that btrfs is way slower even under Zstd:1, while lzo has nearly no difference compared with non-compressed.\nCreate subvolumes: 1 2 3 4 5 6 7 8 9 10 11 12 13 btrfs subvol create /mnt/@ btrfs subvol create /mnt/@home btrfs subvol create /mnt/@cache btrfs subvol create /mnt/@docker btrfs subvol create /mnt/@log btrfs subvol create /mnt/@tmp btrfs subvol create /mnt/@swap # Use chattr to disable COW chattr +C /mnt/@cache chattr +C /mnt/@log chattr +C /mnt/@swap # Umount the partition umount /mnt Mount partitions and subvolumes 1 2 3 4 5 6 7 8 mount -o noatime,nodiratime,ssd,compress=lzo,subvol=@ /dev/sda2 /mnt mkdir -p /mnt/{boot/efi,home,var/{log,lib/docker,cache},tmp,swap} mount -o noatime,nodiratime,ssd,compress=lzo,subvol=@home /dev/sda2 /mnt/home mount -o noatime,nodiratime,ssd,compress=lzo,subvol=@log /dev/sda2 /mnt/var/log mount -o noatime,nodiratime,ssd,compress=lzo,subvol=@docker /dev/sda2 /mnt/var/lib/docker mount -o noatime,nodiratime,ssd,compress=lzo,subvol=@cache /dev/sda2 /mnt/var/cache mount -o noatime,nodiratime,ssd,compress=lzo,subvol=@tmp /dev/sda2 /mnt/tmp mount -o noatime,nodiratime,ssd,compress=lzo,subvol=@swap /dev/sda2 /mnt/swap Mount EFI partition: 1 mount /dev/sda1 /mnt/boot/EFI Install the system 1 pacstrap /mnt base base-devel linux linux-firmware btrfs-progs networkmanager dhcpcd iwd vim sudo zsh zsh-completions {intel,amd}-ucode net-tools linux-headers curl git wget Generate fstab 1 genfstab -U /mnt \u0026gt; /mnt/etc/fstab Check again carefully after generation. Then proceed to post installation.\nPost Installation 1 arch-chroot /mnt\tSet mirror for pacman Use reflector or just update /etc/pacman.d/mirrorlist, then apply changes via pacman -Syy.\nInstall bootloader In this article we use grub as the bootloader, since it is one of a few bootloaders has a good support to btrfs.\n1 pacman -S grub efibootmgr os-prober 1 grub-install --target=x86_64-efi --efi-directory=/boot/efi --bootloader-id=Arch successful results is shown below.\nThen do some optimization. Increase the log level and add nowatchdog param to accelerate the speed of booting and powering off:\n1 nano /etc/default/grub and edit as below:\nSave it and then generate new grub config file to apply changes.\n1 2 3 4 5 6 7 8 9 10 11 [root@archiso /] # grub—mkconfig —o /boot/grub/grub.cfg Generating grub configuration file ... Found linux image: /boot/vmlinuz-linux Found initrd image: /boot/intel—ucode.img /bootzamd—ucode.img /boot/initramfs—linux.img Found fal Iback initrd image(s) in /boot : intel—ucode.img amd—ucode.img initramfs—linux—fallback.img Warning: os—prober will not be executed to detect other bootable partitions. Systems on them will not be added to the GRUB boot configuration. Check documentation entry. Adding boot menu entry for UEFI Firmware Settings ... done Set hostname and hosts 1 2 3 newHostname=\u0026#34;Your-new-hostname\u0026#34; echo $newHostname \u0026gt; /etc/hostname echo -e \u0026#34;127.0.0.1 localhost\\n\u0026#34; \u0026#34;::1 localhost\\n\u0026#34; \u0026#34;127.0.1.1 $newHostname.localdomain $newHostname\u0026#34; \u0026gt;\u0026gt; /etc/hosts Set Timezone 1 ln -sf /usr/share/zoneinfo/Asia/Hong_Kong /etc/localtime Set locale 1 nano /etc/locale.gen and uncomment en-US.UTF-8 UTF-8 and any locale you wanna to use, then generate locale and set en_US locale:\n1 locale-gen \u0026amp;\u0026amp; echo \u0026#39;LANG=en_US.UTF-8\u0026#39; \u0026gt; /etc/locale.conf Setting up user accounts First set the root account password:\n1 passwd root\t1 2 yourName=\u0026#34;example\u0026#34; useradd -m $yourName \u0026amp;\u0026amp; echo \u0026#34;Set a new password for the user $yourName\u0026#34; \u0026amp;\u0026amp; passwd $yourName Desktop Environment In this article we install KDE:\n1 pacman -S plasma plasma-wayland-session egl-wayland kde-{accessibility,graphics,multimedia,network,pim,sdk,system,utilities}-meta VMware Tools Arch Linux is not supported in the official VMware Tools. OpenVMTools is commonly used.\nUsing Open VM Tools one cannot resize the screeen properly. Here\u0026rsquo;s a solution following to a reddit post:\n1 2 3 4 5 sudo pacman -Syu sudo pacman -S open-vm-tools sudo pacman -Su xf86-input-vmmouse xf86-video-vmware mesa gtk2 gtkmm echo needs_root_rights=yes | sudo tee /etc/X11/Xwrapper.config sudo systemctl enable --now vmtoolsd And you are good to go.\nReference:\nhttps://blog.zrlab.org/posts/arch-btrfs\nhttps://wiki.archwiki.org\nhttps://ericclose.github.io/Installing-Arch-as-a-guest-with-UEFI-and-GPT.html\nhttps://arch.icekylin.online/rookie/basic-install.html\nhttps://www.reddit.com/r/archlinux/comments/b0ona0/vmtools_on_arch_linux_full_screen_or_resizing/\n","date":"2023-01-13T23:07:11+08:00","permalink":"http://localhost:1313/p/installing-archlinux-with-btrfs-in-vmware/","title":"Installing ArchLinux With Btrfs in Vmware"},{"content":"Intro Lenovo Legion series Laptops uses IdeaPad ACPI and ones in normal configuration can use nearly all of the function keys except for F9(Favorite key), F11(tab switching key) and F12(Calculator key), since ACPI key functions is not defined:\n1 2 3 4 sudo acpi_listen 8FC0DE0C-B4E4- 000000d0 00000000 #F9 ^[^[[27;5;9~ #F11 8FC0DE0C-B4E4- 000000d0 00000000 #F12 But for users have \u0026ldquo;discrete graphics\u0026rdquo; option switched on in BIOS, F5(Brightness Up) and F6(Brightness Down) is not working, although running acpi_listen shows everything is normal:\n1 2 3 sudo acpi_listen video/brightnessup BRTUP 00000086 00000000 #F6 video/brightnessdown BRTDN 00000087 00000000 #F5 ​\tThe reason is the device controlling backlight now has changed to nvidia_0, not correspond to the defined acpi actions. For Arch Linux users You can install xbacklight to tweak the backlight via command line. But that experience is extremely awful: everytime you want to adjust, you have to turn on console and run xbacklight with root permission. This article is aimed to fix the malfunctioned key.\n​\tREMEMBER: you still can not adjust brightness in \u0026ldquo;battery and brightness\u0026rdquo;.\nSolution ​\tJust create these files and reboot.\n/etc/acpi/events/FnF6-brightnessup 1 2 3 #FnF6 video/brightnessup BRTUP 00000086 00000000 event=video/brightnessup action=/etc/acpi/actions/FnF6-brightnessup.sh /etc/acpi/actions/FnF6-brightnessup.sh 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 #!/bin/bash # Set the static increment value. Keep in mind that this will # be done twice. # This Value is depended on the actual changing value of the DE(in KDE it\u0026#39;s 6) IncVal=6 # Get the Maximum value for use. #MaxVal=$(cat /sys/class/backlight/intel_backlight/max_brightness); read -r MaxVal \u0026lt; \u0026#34;/sys/class/backlight/nvidia_0/max_brightness\u0026#34; # Get the current brightness value. #CurrVal=$(cat /sys/class/backlight/nvidia_0/brightness); read -r CurrVal \u0026lt; \u0026#34;/sys/class/backlight/nvidia_0/brightness\u0026#34; # Set the new value minus the decrement value. NewVal=$(($CurrVal + $IncVal)); echo $NewVal # Set it to the threshold of the max value. ThresholdVal=$(($NewVal\u0026lt;$MaxVal?$NewVal:$MaxVal)) echo $ThresholdVal # Set the new value directly. echo -n $ThresholdVal \u0026gt; /sys/class/backlight/nvidia_0/brightness logger \u0026#34;[ACPI] brightnessup |$CurrVal| |$NewVal| |$ThresholdVal|\u0026#34; /etc/acpi/events/FnF5-brightnessdown 1 2 3 #FnF5 video/brightnessdown BRTDN 00000087 00000000 event=video/brightnessdown action=/etc/acpi/actions/FnF5-brightnessdown.sh /etc/acpi/actions/FnF5-brightnessdown.sh 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 #!/bin/bash # Set the static decrement value. Keep in mind that this will # be done twice. # This Value is depended on the actual changing value of the DE(in KDE it\u0026#39;s 6) DecVal=6 # Set the Minimum we will accept. MinVal=0 # Get the current brightness value. #CurrVal=$(cat /sys/class/backlight/nvidia_0/brightness); read -r CurrVal \u0026lt; \u0026#34;/sys/class/backlight/nvidia_0/brightness\u0026#34; # Set the new value minus the decrement value. NewVal=$(($CurrVal - $DecVal)); echo $NewVal # Set it to the threshold of the min value. ThresholdVal=$(($NewVal\u0026gt;$MinVal?$NewVal:$MinVal)) echo $ThresholdVal # Set the new value directly. echo -n $ThresholdVal \u0026gt; /sys/class/backlight/nvidia_0/brightness logger \u0026#34;[ACPI] brightnessdown |$CurrVal| |$NewVal| |$ThresholdVal|\u0026#34; ","date":"2022-11-08T02:06:00Z","permalink":"http://localhost:1313/p/fixing-the-brightness-function-keys-in-legion-laptops-with-discrete-graphics-option-enabled/","title":"Fixing the brightness function keys in Legion laptops with discrete graphics option enabled"},{"content":"Some useful markdown note taking codes Maths In-line maths(LaTeX?) expressions Turn on the \u0026ldquo;In-line Math Equation\u0026rdquo; option in your editor. In my editor Typora, you can turn it on in File\u0026gt;\u0026gt;Preferences\u0026gt;\u0026gt;Markdown\u0026gt;\u0026gt;Syntax Support\u0026gt;\u0026gt;Inline Math. Then just write as the following(Please don\u0026rsquo;t judge whether the equation is wrong or not, after all, this is just a demonstration.):\n1 $inline \\ math \\ example: \\ f(x)=x^2+y_2$ It will look like $inline \\ math \\ example: \\ f(x)=x^2+y_2$\nNote taking Changing the text and background colour Markdown is not able to change text number by default. But by writing HTML code, one could change the text color and bkg colour.\nHere\u0026rsquo;s an example\n1 2 3 \u0026lt;span style=\u0026#34;color:\u0026#39;the colour name or the html colour code\u0026#39;\u0026#34;\u0026gt;text\u0026lt;/span\u0026gt; //text colour \u0026lt;span style=\u0026#34;background-color:\u0026#39;the colour name or the html colour code\u0026#39;\u0026#34;\u0026gt;text\u0026lt;/span\u0026gt; //background colour blue\nyellow background colour\nMore interestingly, you could still use markdown format inside the html rendering:\n1 2 3 4 5 \u0026lt;span style=\u0026#34;background-color:#00ffff\u0026#34;\u0026gt;\u0026lt;span style=\u0026#34;color:red\u0026#34;\u0026gt;Red text\u0026lt;/span\u0026gt; in cyan background colour\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026#34;background-color:#00ffff\u0026#34;\u0026gt;\u0026lt;span style=\u0026#34;color:red\u0026#34;\u0026gt;**Bold red text**\u0026lt;/span\u0026gt; in cyan background colour\u0026lt;/span\u0026gt; \u0026lt;span style=\u0026#34;background-color:#00ffff\u0026#34;\u0026gt;\u0026lt;span style=\u0026#34;color:red\u0026#34;\u0026gt;**Bold red $LaTeX$ expression**\u0026lt;/span\u0026gt; in cyan background colour\u0026lt;/span\u0026gt; Red text in cyan background colour\nBold red text in cyan background colour\nBold red $LaTeX$ expression in cyan background colour\n","date":"2022-09-16T16:00:00Z","permalink":"http://localhost:1313/p/some-useful-markdown-noting-codes/","title":"Some useful markdown noting codes"},{"content":"How to make a combined brother printer driver AUR package TODO Analyze differences of file trees between the two types Analyze differences of the installation processes between the two types Intro Traditionally, Brother printers\u0026rsquo; drivers are divided with cupswrapper and lpr. The Arch-Wiki gives the solution on how to package them. But there\u0026rsquo;s some printers, e.g. DCP-B7500D and HL-L2350DW, have a combined driver with different file tree. This article is to record how I package.\nPreparation Arch-Linux PC (of cause) .deb or .rpm download link Have learn how to make AUR package https://wiki.archlinux.org/title/Arch_package_guidelines Write PKGBUILD Usually they have a common version 4.0.0\nJust make your own adaptation to my PKGBUILD (adapted from Roman Schmocker\u0026rsquo;s brother-hll2350dw package):\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 # Maintainer: ous50 pkgname=brother-dcpb7500d printerModel=DCPB7500D pkgver=4.0.0 pkgrel=1 pkgdesc=\u0026#34;Printing driver for Brother DCP-B7500 printer\u0026#34; arch=(\u0026#34;i686\u0026#34; \u0026#34;x86_64\u0026#34; \u0026#34;armv7l\u0026#34;) //check the \u0026#39;/opt/brother/Printers/$printerModel/lpd\u0026#39; in the data.tar.gz url=\u0026#34;https://support.brother.com/g/b/producttop.aspx?c=in\u0026amp;lang=en\u0026amp;prod=dcpb7500d_as_cn\u0026#34; license=(\u0026#34;EULA\u0026#34;) groups=(\u0026#34;base-devel\u0026#34;) depends=(\u0026#39;cups\u0026#39; \u0026#39;ghostscript\u0026#39;) depends_x86_64=(\u0026#39;lib32-glibc\u0026#39;) install=\u0026#34;$pkgname.install\u0026#34; source=( \u0026#34;https://download.brother.com/welcome/dlf103663/dcpb7500dpdrv-$pkgver-1.i386.deb\u0026#34; \u0026#39;cupswrapper-license.txt\u0026#39; \u0026#39;lpr-license.txt\u0026#39; ) md5sums=( \u0026#34;c5d5c7febae0eab6254cb7332f4038c0\u0026#34; \u0026#39;97ad0cffd216059e9d1d3121899d8646\u0026#39; \u0026#39;5e87a3dc0f3e3438c088eda0f3565f0d\u0026#39; ) package(){ tar xf data.tar.gz // If you use .deb as your source, you must use this to fully decompress. (Not tested on .rpm packages) cp -R \u0026#34;$srcdir/opt\u0026#34; \u0026#34;$pkgdir/opt\u0026#34; ln -s \u0026#34;/opt/brother/Printers/DCPB7500D/lpd/$CARCH/rawtobr3\u0026#34; \u0026#34;$pkgdir/opt/brother/Printers/DCPB7500D/lpd/rawtobr3\u0026#34; ln -s \u0026#34;/opt/brother/Printers/DCPB7500D/lpd/$CARCH/brprintconflsr3\u0026#34; \u0026#34;$pkgdir/opt/brother/Printers/DCPB7500D/lpd/brprintconflsr3\u0026#34; install -d \u0026#34;$pkgdir/usr/lib/cups/filter/\u0026#34; ln -s \u0026#34;/opt/brother/Printers/DCPB7500D/cupswrapper/lpdwrapper\u0026#34; \u0026#34;$pkgdir/usr/lib/cups/filter/brother_lpdwrapper_DCPB7500D\u0026#34; install -d \u0026#34;$pkgdir/usr/share/cups/model/\u0026#34; ln -s \u0026#34;/opt/brother/Printers/DCPB7500D/cupswrapper/brother-DCPB7500D-cups-en.ppd\u0026#34; \u0026#34;$pkgdir/usr/share/cups/model\u0026#34; install -Dm644 \u0026#34;$srcdir/opt/brother/Printers/DCPB7500D/LICENSE_ENG.txt\u0026#34; \u0026#34;$pkgdir/usr/share/licenses/$pkgname/LICENSE_ENG.txt\u0026#34; install -Dm644 \u0026#34;$srcdir/opt/brother/Printers/DCPB7500D/LICENSE_JPN.txt\u0026#34; \u0026#34;$pkgdir/usr/share/licenses/$pkgname/LICENSE_JPN.txt\u0026#34; } Remember to get \u0026lsquo;cupswrapper-license.txt\u0026rsquo; and \u0026rsquo;lpr-license.txt\u0026rsquo; or just delete them from source\nFor better notice of user installation, you could write a xxx.install file to help(in my case the filename is brother-dcpb7500d.install):\n1 2 3 4 5 6 7 8 9 post_install() { post_upgrade; } post_upgrade() { echo \u0026#34;Restart CUPS service to load the new files\u0026#34; echo \u0026#34;You can now register your new printer using the web interface at:\u0026#34; echo \u0026#34; http://localhost:631/\u0026#34; } Test installation and upload After you have saved the PKGBUILD, do a test installation:\n1 makepkg -rcsi restart cups.service after installation and go to check if your model has shown in the list:\nIf it\u0026rsquo;s shown, then you could upload it to AUR\nTips: In settings you might see an error like:\n1 Failed to search for a recommended driver: \u0026#39;The name org.fedoraproject.Config.Printing was not provided by any .service files\u0026#39; In this case you need to install system-config-printer package:\n1 sudo pacman -S system-config-printer Thanks Many thanks to Roman Schmocker. Without you it would be much harder to finish my AUR package and of course, this blog.\nThanks Arch-Wiki contributors for good documentations.\n","date":"2022-01-25T03:46:22Z","permalink":"http://localhost:1313/p/how-to-make-a-combined-brother-printer-driver-aur-package/","title":"How to make a combined brother printer driver AUR package"},{"content":"Enabling CUDA in ArchLinux WSL2 This article is deprecated, use pure Linux instead\nTroubleshoot libcuda cannot link when using,\n1 /sbin/ldconfig.real: Can\u0026#39;t link /usr/lib/wsl/lib/libcuda.so.1 to libcuda.so.1.1 According to\nhttps://github.com/microsoft/WSL/issues/5548 https://github.com/microsoft/WSL/issues/5663 https://gist.github.com/slavistan/53c8e2627bf9ca202ab6c56ef4d5c497\n/usr/lib/wsl/lib is casted from windows and all of them is treated as files. should create a new casting folder:\n1 sudo ln -s /usr/lib/wsl/lib/libcuda.so.1 /usr/local/cuda/lib64/libcuda.so method 2:\n1 2 3 4 5 echo -e \u0026#34;[automount]\\nldconfig = false\u0026#34; | sudo tee -a /etc/wsl.conf sudo mkdir /usr/lib/wsl/lib2 sudo ln -s /usr/lib/wsl/lib/* /usr/lib/wsl/lib2 echo /usr/lib/wsl/lib2 | sudo tee /etc/ld.so.conf.d/ld.wsl.conf method 3 (For Windows 11 users):\nadd the following to /etc/wsl.conf:\n1 2 [boot] command = sleep 10 ; mount --bind /usr/lib/wsl/lib /usr/lib/wsl/lib2 -o X-mount.mkdir ; umount /usr/lib/wsl/lib ","date":"0001-01-01T00:00:00Z","permalink":"http://localhost:1313/p/","title":""}]